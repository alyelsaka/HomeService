<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Dashboard - HomeServices</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Language selector styling */
        .language-selector {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 1000;
        }

        #language-selector {
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ccc;
            background-color: #fff;
            color: #333;
            font-size: 16px;
        }

        /* RTL support for Arabic */
        body[dir="rtl"] {
            direction: rtl;
            text-align: right;
        }
    </style>
</head>
<body class="dashboard-body">
    <!-- Navigation Bar -->
    <nav class="dashboard-nav">
        <div class="nav-brand" onclick="location.href='index.html'" data-translate="home">HomeServices</div>
        <div class="client-info">
            <span id="clientName" data-translate="welcome">Welcome, <span id="clientNamePlaceholder">Loading...</span></span>
            <button onclick="logout()" class="logout-btn">
                <i class="fas fa-sign-out-alt"></i> <span data-translate="logout">Logout</span>
            </button>
        </div>
    </nav>

    <!-- Dashboard Container -->
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="dashboard-sidebar">
            <div class="profile-section">
                <div class="profile-image">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="client-status">
                    <span id="currentStatus" class="status-badge active" data-translate="active">Active</span>
                </div>
            </div>

            <nav class="sidebar-nav">
                <button class="nav-item active" onclick="showSection('serviceSearch')">
                    <i class="fas fa-search"></i> <span data-translate="serviceSearch">Service Search</span>
                </button>
                <button class="nav-item" onclick="showSection('bookings')">
                    <i class="fas fa-calendar-alt"></i> <span data-translate="myBookings">My Bookings</span>
                </button>
                <button class="nav-item" onclick="showSection('reviews')">
                    <i class="fas fa-star"></i> <span data-translate="reviews">Reviews</span>
                </button>
                <button class="nav-item" onclick="showSection('payments')">
                    <i class="fas fa-credit-card"></i> <span data-translate="paymentMethods">Payment Methods</span>
                </button>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="dashboard-main">
            <!-- Service Search Section -->
            <section id="serviceSearch" class="dashboard-section active">
                <h2 data-translate="serviceSearch">Service Search</h2>
                <div class="search-bar">
                    <input type="text" id="serviceSearchInput" placeholder="Search for services..." data-translate="searchPlaceholder">
                    <button onclick="searchServices()"><i class="fas fa-search"></i></button>
                </div>
                <div id="servicesContainer" class="services-grid">
                    <p data-translate="loadingServices">Loading services...</p>
                </div>
            </section>

            <!-- My Bookings Section -->
            <section id="bookings" class="dashboard-section">
                <h2 data-translate="myBookings">My Bookings</h2>
                <div id="bookingsContainer" class="bookings-grid">
                    <p data-translate="loadingBookings">Loading bookings...</p>
                </div>
            </section>

            <!-- Reviews Section -->
            <section id="reviews" class="dashboard-section">
                <h2 data-translate="reviews">Reviews</h2>
                <div id="reviewsContainer" class="reviews-grid">
                    <p data-translate="loadingReviews">Loading reviews...</p>
                </div>
            </section>

            <!-- Payment Methods Section -->
            <section id="payments" class="dashboard-section">
                <h2 data-translate="paymentMethods">Payment Methods</h2>
                <div id="paymentsContainer" class="payments-grid">
                    <p data-translate="loadingPayments">Loading payment methods...</p>
                </div>
            </section>
        </main>
    </div>

    <!-- Footer -->
    <footer class="dashboard-footer">
        <p data-translate="contactUs">Contact us: support@homeservices.com | +123 456 7890</p>
        <div class="social-media">
            <a href="#"><i class="fab fa-facebook"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
        </div>
    </footer>

    <!-- Language Selector -->
    <div class="language-selector">
        <select id="language-selector" onchange="changeLanguage(this.value)">
            <option value="en">ğŸ‡ºğŸ‡¸ English</option>
            <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡ (Chinese)</option>
            <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol (Spanish)</option>
            <option value="hi">ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤¨à¥à¤¦à¥€ (Hindi)</option>
            <option value="ar">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Arabic)</option>
            <option value="pt">ğŸ‡µğŸ‡¹ PortuguÃªs (Portuguese)</option>
            <option value="bn">ğŸ‡§ğŸ‡© à¦¬à¦¾à¦‚à¦²à¦¾ (Bengali)</option>
            <option value="ru">ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹ (Russian)</option>
            <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª (Japanese)</option>
            <option value="pa">ğŸ‡®ğŸ‡³ à¨ªà©°à¨œà¨¾à¨¬à©€ (Punjabi)</option>
            <option value="de">ğŸ‡©ğŸ‡ª Deutsch (German)</option>
            <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais (French)</option>
        </select>
    </div>

    <script>
        // Define translations for all supported languages
        const translations = {
            en: {
                home: "HomeServices",
                welcome: "Welcome",
                logout: "Logout",
                active: "Active",
                serviceSearch: "Service Search",
                myBookings: "My Bookings",
                reviews: "Reviews",
                paymentMethods: "Payment Methods",
                searchPlaceholder: "Search for services...",
                loadingServices: "Loading services...",
                loadingBookings: "Loading bookings...",
                loadingReviews: "Loading reviews...",
                loadingPayments: "Loading payment methods...",
                contactUs: "Contact us: support@homeservices.com | +123 456 7890"
            },
            zh: {
                home: "å®¶åº­æœåŠ¡",
                welcome: "æ¬¢è¿",
                logout: "ç™»å‡º",
                active: "æ´»è·ƒ",
                serviceSearch: "æœåŠ¡æœç´¢",
                myBookings: "æˆ‘çš„é¢„è®¢",
                reviews: "è¯„è®º",
                paymentMethods: "æ”¯ä»˜æ–¹å¼",
                searchPlaceholder: "æœç´¢æœåŠ¡...",
                loadingServices: "æ­£åœ¨åŠ è½½æœåŠ¡...",
                loadingBookings: "æ­£åœ¨åŠ è½½é¢„è®¢...",
                loadingReviews: "æ­£åœ¨åŠ è½½è¯„è®º...",
                loadingPayments: "æ­£åœ¨åŠ è½½æ”¯ä»˜æ–¹å¼...",
                contactUs: "è”ç³»æˆ‘ä»¬: support@homeservices.com | +123 456 7890"
            },
            es: {
                home: "Servicios del Hogar",
                welcome: "Bienvenido",
                logout: "Cerrar sesiÃ³n",
                active: "Activo",
                serviceSearch: "BÃºsqueda de Servicios",
                myBookings: "Mis Reservas",
                reviews: "ReseÃ±as",
                paymentMethods: "MÃ©todos de Pago",
                searchPlaceholder: "Buscar servicios...",
                loadingServices: "Cargando servicios...",
                loadingBookings: "Cargando reservas...",
                loadingReviews: "Cargando reseÃ±as...",
                loadingPayments: "Cargando mÃ©todos de pago...",
                contactUs: "ContÃ¡ctenos: support@homeservices.com | +123 456 7890"
            },
            hi: {
                home: "à¤¹à¥‹à¤® à¤¸à¤°à¥à¤µà¤¿à¤¸à¥‡à¤œ",
                welcome: "à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆ",
                logout: "à¤²à¥‰à¤—à¤†à¤‰à¤Ÿ",
                active: "à¤¸à¤•à¥à¤°à¤¿à¤¯",
                serviceSearch: "à¤¸à¥‡à¤µà¤¾ à¤–à¥‹à¤œ",
                myBookings: "à¤®à¥‡à¤°à¥€ à¤¬à¥à¤•à¤¿à¤‚à¤—",
                reviews: "à¤¸à¤®à¥€à¤•à¥à¤·à¤¾à¤à¤‚",
                paymentMethods: "à¤­à¥à¤—à¤¤à¤¾à¤¨ à¤µà¤¿à¤§à¤¿à¤¯à¤¾à¤‚",
                searchPlaceholder: "à¤¸à¥‡à¤µà¤¾à¤à¤‚ à¤–à¥‹à¤œà¥‡à¤‚...",
                loadingServices: "à¤¸à¥‡à¤µà¤¾à¤à¤‚ à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¥€ à¤¹à¥ˆà¤‚...",
                loadingBookings: "à¤¬à¥à¤•à¤¿à¤‚à¤— à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¥€ à¤¹à¥ˆà¤‚...",
                loadingReviews: "à¤¸à¤®à¥€à¤•à¥à¤·à¤¾à¤à¤‚ à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¥€ à¤¹à¥ˆà¤‚...",
                loadingPayments: "à¤­à¥à¤—à¤¤à¤¾à¤¨ à¤µà¤¿à¤§à¤¿à¤¯à¤¾à¤‚ à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¥€ à¤¹à¥ˆà¤‚...",
                contactUs: "à¤¹à¤®à¤¸à¥‡ à¤¸à¤‚à¤ªà¤°à¥à¤• à¤•à¤°à¥‡à¤‚: support@homeservices.com | +123 456 7890"
            },
            ar: {
                home: "Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„",
                welcome: "Ù…Ø±Ø­Ø¨Ù‹Ø§",
                logout: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",
                active: "Ù†Ø´Ø·",
                serviceSearch: "Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø®Ø¯Ù…Ø§Øª",
                myBookings: "Ø­Ø¬ÙˆØ²Ø§ØªÙŠ",
                reviews: "Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª",
                paymentMethods: "Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹",
                searchPlaceholder: "Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø®Ø¯Ù…Ø§Øª...",
                loadingServices: "Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª...",
                loadingBookings: "Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª...",
                loadingReviews: "Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª...",
                loadingPayments: "Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹...",
                contactUs: "Ø§ØªØµÙ„ Ø¨Ù†Ø§: support@homeservices.com | +123 456 7890"
            },
            pt: {
                home: "ServiÃ§os DomÃ©sticos",
                welcome: "Bem-vindo",
                logout: "Sair",
                active: "Ativo",
                serviceSearch: "Pesquisa de ServiÃ§os",
                myBookings: "Minhas Reservas",
                reviews: "AvaliaÃ§Ãµes",
                paymentMethods: "MÃ©todos de Pagamento",
                searchPlaceholder: "Pesquisar serviÃ§os...",
                loadingServices: "Carregando serviÃ§os...",
                loadingBookings: "Carregando reservas...",
                loadingReviews: "Carregando avaliaÃ§Ãµes...",
                loadingPayments: "Carregando mÃ©todos de pagamento...",
                contactUs: "Contate-nos: support@homeservices.com | +123 456 7890"
            },
            bn: {
                home: "à¦¹à§‹à¦® à¦¸à¦¾à¦°à§à¦­à¦¿à¦¸à§‡à¦¸",
                welcome: "à¦¸à§à¦¬à¦¾à¦—à¦¤à¦®",
                logout: "à¦²à¦—à¦†à¦‰à¦Ÿ",
                active: "à¦¸à¦•à§à¦°à¦¿à¦¯à¦¼",
                serviceSearch: "à¦¸à¦¾à¦°à§à¦­à¦¿à¦¸ à¦…à¦¨à§à¦¸à¦¨à§à¦§à¦¾à¦¨",
                myBookings: "à¦†à¦®à¦¾à¦° à¦¬à§à¦•à¦¿à¦‚",
                reviews: "à¦ªà¦°à§à¦¯à¦¾à¦²à§‹à¦šà¦¨à¦¾",
                paymentMethods: "à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦ªà¦¦à§à¦§à¦¤à¦¿",
                searchPlaceholder: "à¦¸à¦¾à¦°à§à¦­à¦¿à¦¸ à¦…à¦¨à§à¦¸à¦¨à§à¦§à¦¾à¦¨ à¦•à¦°à§à¦¨...",
                loadingServices: "à¦¸à¦¾à¦°à§à¦­à¦¿à¦¸ à¦²à§‹à¦¡ à¦¹à¦šà§à¦›à§‡...",
                loadingBookings: "à¦¬à§à¦•à¦¿à¦‚ à¦²à§‹à¦¡ à¦¹à¦šà§à¦›à§‡...",
                loadingReviews: "à¦ªà¦°à§à¦¯à¦¾à¦²à§‹à¦šà¦¨à¦¾ à¦²à§‹à¦¡ à¦¹à¦šà§à¦›à§‡...",
                loadingPayments: "à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦ªà¦¦à§à¦§à¦¤à¦¿ à¦²à§‹à¦¡ à¦¹à¦šà§à¦›à§‡...",
                contactUs: "à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦— à¦•à¦°à§à¦¨: support@homeservices.com | +123 456 7890"
            },
            ru: {
                home: "Ğ”Ğ¾Ğ¼Ğ°ÑˆĞ½Ğ¸Ğµ Ğ£ÑĞ»ÑƒĞ³Ğ¸",
                welcome: "Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ",
                logout: "Ğ’Ñ‹Ğ¹Ñ‚Ğ¸",
                active: "ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹",
                serviceSearch: "ĞŸĞ¾Ğ¸ÑĞº Ğ£ÑĞ»ÑƒĞ³",
                myBookings: "ĞœĞ¾Ğ¸ Ğ‘Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ",
                reviews: "ĞÑ‚Ğ·Ñ‹Ğ²Ñ‹",
                paymentMethods: "ĞœĞµÑ‚Ğ¾Ğ´Ñ‹ ĞĞ¿Ğ»Ğ°Ñ‚Ñ‹",
                searchPlaceholder: "ĞŸĞ¾Ğ¸ÑĞº ÑƒÑĞ»ÑƒĞ³...",
                loadingServices: "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ÑƒÑĞ»ÑƒĞ³...",
                loadingBookings: "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ±Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹...",
                loadingReviews: "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¾Ñ‚Ğ·Ñ‹Ğ²Ğ¾Ğ²...",
                loadingPayments: "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ¾Ğ² Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹...",
                contactUs: "Ğ¡Ğ²ÑĞ¶Ğ¸Ñ‚ĞµÑÑŒ Ñ Ğ½Ğ°Ğ¼Ğ¸: support@homeservices.com | +123 456 7890"
            },
            ja: {
                home: "ãƒ›ãƒ¼ãƒ ã‚µãƒ¼ãƒ“ã‚¹",
                welcome: "ã‚ˆã†ã“ã",
                logout: "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ",
                active: "ã‚¢ã‚¯ãƒ†ã‚£ãƒ–",
                serviceSearch: "ã‚µãƒ¼ãƒ“ã‚¹æ¤œç´¢",
                myBookings: "äºˆç´„ä¸€è¦§",
                reviews: "ãƒ¬ãƒ“ãƒ¥ãƒ¼",
                paymentMethods: "æ”¯æ‰•ã„æ–¹æ³•",
                searchPlaceholder: "ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ¤œç´¢...",
                loadingServices: "ã‚µãƒ¼ãƒ“ã‚¹ã‚’èª­ã¿è¾¼ã¿ä¸­...",
                loadingBookings: "äºˆç´„ã‚’èª­ã¿è¾¼ã¿ä¸­...",
                loadingReviews: "ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’èª­ã¿è¾¼ã¿ä¸­...",
                loadingPayments: "æ”¯æ‰•ã„æ–¹æ³•ã‚’èª­ã¿è¾¼ã¿ä¸­...",
                contactUs: "ãŠå•ã„åˆã‚ã›: support@homeservices.com | +123 456 7890"
            },
            pa: {
                home: "à¨˜à¨° à¨¸à©‡à¨µà¨¾à¨µà¨¾à¨‚",
                welcome: "à¨œà©€ à¨†à¨‡à¨†à¨‚ à¨¨à©‚à©°",
                logout: "à¨²à©Œà¨—à¨†à¨‰à¨Ÿ",
                active: "à¨¸à¨°à¨—à¨°à¨®",
                serviceSearch: "à¨¸à©‡à¨µà¨¾ à¨–à©‹à¨œ",
                myBookings: "à¨®à©‡à¨°à©€à¨†à¨‚ à¨¬à©à¨•à¨¿à©°à¨—à¨¾à¨‚",
                reviews: "à¨¸à¨®à©€à¨–à¨¿à¨†à¨µà¨¾à¨‚",
                paymentMethods: "à¨­à©à¨—à¨¤à¨¾à¨¨ à¨µà¨¿à¨§à©€à¨†à¨‚",
                searchPlaceholder: "à¨¸à©‡à¨µà¨¾à¨µà¨¾à¨‚ à¨–à©‹à¨œà©‹...",
                loadingServices: "à¨¸à©‡à¨µà¨¾à¨µà¨¾à¨‚ à¨²à©‹à¨¡ à¨¹à©‹ à¨°à¨¹à©€à¨†à¨‚ à¨¹à¨¨...",
                loadingBookings: "à¨¬à©à¨•à¨¿à©°à¨—à¨¾à¨‚ à¨²à©‹à¨¡ à¨¹à©‹ à¨°à¨¹à©€à¨†à¨‚ à¨¹à¨¨...",
                loadingReviews: "à¨¸à¨®à©€à¨–à¨¿à¨†à¨µà¨¾à¨‚ à¨²à©‹à¨¡ à¨¹à©‹ à¨°à¨¹à©€à¨†à¨‚ à¨¹à¨¨...",
                loadingPayments: "à¨­à©à¨—à¨¤à¨¾à¨¨ à¨µà¨¿à¨§à©€à¨†à¨‚ à¨²à©‹à¨¡ à¨¹à©‹ à¨°à¨¹à©€à¨†à¨‚ à¨¹à¨¨...",
                contactUs: "à¨¸à¨¾à¨¡à©‡ à¨¨à¨¾à¨² à¨¸à©°à¨ªà¨°à¨• à¨•à¨°à©‹: support@homeservices.com | +123 456 7890"
            },
            de: {
                home: "Hausdienstleistungen",
                welcome: "Willkommen",
                logout: "Abmelden",
                active: "Aktiv",
                serviceSearch: "Dienstesuche",
                myBookings: "Meine Buchungen",
                reviews: "Bewertungen",
                paymentMethods: "Zahlungsmethoden",
                searchPlaceholder: "Dienste suchen...",
                loadingServices: "Dienste werden geladen...",
                loadingBookings: "Buchungen werden geladen...",
                loadingReviews: "Bewertungen werden geladen...",
                loadingPayments: "Zahlungsmethoden werden geladen...",
                contactUs: "Kontaktieren Sie uns: support@homeservices.com | +123 456 7890"
            },
            fr: {
                home: "Services Ã  Domicile",
                welcome: "Bienvenue",
                logout: "DÃ©connexion",
                active: "Actif",
                serviceSearch: "Recherche de Services",
                myBookings: "Mes RÃ©servations",
                reviews: "Avis",
                paymentMethods: "MÃ©thodes de Paiement",
                searchPlaceholder: "Rechercher des services...",
                loadingServices: "Chargement des services...",
                loadingBookings: "Chargement des rÃ©servations...",
                loadingReviews: "Chargement des avis...",
                loadingPayments: "Chargement des mÃ©thodes de paiement...",
                contactUs: "Contactez-nous: support@homeservices.com | +123 456 7890"
            }
        };

        // Function to change language
        function changeLanguage(language) {
            const elements = document.querySelectorAll('[data-translate]');
            elements.forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[language] && translations[language][key]) {
                    element.textContent = translations[language][key];
                }
            });

            // Update text direction for RTL languages (e.g., Arabic)
            if (language === "ar") {
                document.body.setAttribute("dir", "rtl");
            } else {
                document.body.setAttribute("dir", "ltr");
            }
        }

        // Initialize with default language (English)
        document.addEventListener('DOMContentLoaded', () => {
            changeLanguage('en');
        });

        // Fetch client details on page load
        async function fetchClientDetails() {
            try {
                const response = await fetch('/auth/user', {
                    headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }
                });
                const data = await response.json();
                document.getElementById('clientNamePlaceholder').textContent = data.user.name;
            } catch (error) {
                console.error('Error fetching client details:', error);
            }
        }

        // Fetch available services
        async function searchServices() {
            const container = document.getElementById('servicesContainer');
            container.innerHTML = '<p data-translate="loadingServices">Loading services...</p>';
            try {
                const response = await fetch('/auth/services/available', {
                    headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }
                });
                const services = await response.json();
                container.innerHTML = ''; // Clear existing content
                services.forEach(service => {
                    const card = document.createElement('div');
                    card.classList.add('service-card');
                    card.setAttribute('data-service-id', service.id); // Add data attribute for service ID
                    card.innerHTML = `
                        <div class="service-header">
                            <h3>${service.name}</h3>
                        </div>
                        <div class="service-details">
                            <p><i class="fas fa-tools"></i> Service Type: ${service.service_type}</p>
                            <p><i class="fas fa-money-bill-wave"></i> Price: $${service.price}</p>
                            <p><i class="fas fa-user"></i> Worker: ${service.worker_name}</p>
                        </div>
                        <div class="service-actions">
                            <button onclick="bookService(${service.id}, ${service.worker_id})">Book Now</button>
                        </div>
                    `;
                    container.appendChild(card);
                });
            } catch (error) {
                console.error('Error fetching services:', error);
                container.innerHTML = '<p data-translate="loadingServices">Failed to load services. Please try again later.</p>';
            }
        }

        // Book a service
      // Book a service
async function bookService(serviceId, workerId) {
    try {
        const requestBody = {
            service_id: serviceId,
            worker_id: workerId,
            booking_date: new Date().toISOString().split('T')[0], // Current date in YYYY-MM-DD format
            start_time: '09:00', // Default start time
            end_time: '17:00',   // Default end time
            rate_per_hour: 50    // Default rate per hour
        };

        console.log('Request Body:', requestBody); // Log the request body

        const response = await fetch('/api/bookings', {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${localStorage.getItem('token')}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestBody)
        });

        const result = await response.json();

        if (response.ok) {
            alert(result.message || 'Service booked successfully!');

            // Remove the booked service from the DOM
            const serviceCard = document.querySelector(`.service-card[data-service-id="${serviceId}"]`);
            if (serviceCard) {
                serviceCard.remove();
            }

            loadBookings(); // Refresh the bookings list
        } else {
            console.error('Booking failed:', result); // Log the error response
            alert(result.message || 'Failed to book service.');
        }
    } catch (error) {
        console.error('Error booking service:', error); // Log the full error
        alert('An error occurred while booking the service.');
    }
}
        // Fetch client bookings
        async function loadBookings() {
            try {
                const response = await fetch('/bookings', {
                    headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }
                });
                const bookings = await response.json();
                console.log('Bookings Data:', bookings); // Log the bookings data

                const container = document.getElementById('bookingsContainer');
                container.innerHTML = bookings.length
                    ? bookings.map(booking => `
                        <div class="booking-card">
                            <h3>${booking.service}</h3>
                            <p>Date: ${new Date(booking.date).toLocaleDateString()}</p>
                            <p>Time: ${booking.start_time} - ${booking.end_time}</p>
                            <p>Price: $${booking.price}</p>
                            <button onclick="cancelBooking(${booking.id})">Cancel</button>
                            <button onclick="rescheduleBooking(${booking.id})">Reschedule</button>
                            <button onclick="showWorkerPhone('${booking.worker_phone}')">Contact Worker</button>
                        </div>`).join('')
                    : '<p data-translate="loadingBookings">No bookings found.</p>';
            } catch (error) {
                console.error('Error loading bookings:', error);
            }
        }

        // Cancel a booking
        async function cancelBooking(bookingId) {
    try {
        const response = await fetch(`/bookings/cancel/${bookingId}`, {
            method: 'DELETE',
            headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }
        });

        const result = await response.json(); // Parse the response as JSON

        if (response.ok) {
            alert(result.message || 'Booking canceled successfully!');
            loadBookings(); // Refresh the bookings list
        } else {
            alert(result.message || 'Failed to cancel booking.');
        }
    } catch (error) {
        console.error('Error canceling booking:', error);
        alert('An error occurred while canceling the booking.');
    }
}
        // Reschedule a booking (placeholder function)
        async function rescheduleBooking(bookingId) {
            try {
                const newDate = prompt('Enter the new date (YYYY-MM-DD):');
                const newTime = prompt('Enter the new time (HH:MM):');

                if (newDate && newTime) {
                    const response = await fetch(`/bookings/reschedule/${bookingId}`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `Bearer ${localStorage.getItem('token')}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ newDate, newTime })
                    });

                    if (response.ok) {
                        alert('Booking rescheduled successfully!');
                        loadBookings(); // Refresh the bookings list
                    } else {
                        alert('Failed to reschedule booking.');
                    }
                } else {
                    alert('Invalid date or time.');
                }
            } catch (error) {
                console.error('Error rescheduling booking:', error);
            }
        }

        // Fetch client reviews
        async function loadReviews() {
            try {
                const response = await fetch('/reviews', {
                    headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }
                });
                const reviews = await response.json();
                const container = document.getElementById('reviewsContainer');
                container.innerHTML = reviews.length
                    ? reviews.map(review => `
                        <div class="review-card">
                            <h3>${review.service}</h3>
                            <p>Rating: ${review.rating}</p>
                            <p>Review: ${review.comment}</p>
                        </div>`).join('')
                    : '<p data-translate="loadingReviews">No reviews found.</p>';
            } catch (error) {
                console.error('Error loading reviews:', error);
            }
        }

        // Fetch payment methods
        async function loadPaymentMethods() {
            try {
                const response = await fetch('/payments', {
                    headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }
                });
                const payments = await response.json();
                const container = document.getElementById('paymentsContainer');
                container.innerHTML = payments.length
                    ? payments.map(payment => `
                        <div class="payment-card">
                            <h3>${payment.type}</h3>
                            <p>Card Number: ${payment.cardNumber}</p>
                            <button onclick="deletePaymentMethod(${payment.id})">Delete</button>
                        </div>`).join('')
                    : '<p data-translate="loadingPayments">No payment methods found.</p>';
            } catch (error) {
                console.error('Error loading payment methods:', error);
            }
        }

        // Function to show the worker's phone number in a popup
        function showWorkerPhone(phoneNumber) {
            const popup = document.createElement('div');
            popup.classList.add('popup');
            popup.innerHTML = `
                <div class="popup-content">
                    <h3>Worker Contact</h3>
                    <p>Phone Number: ${phoneNumber}</p>
                    <button onclick="closePopup()">Close</button>
                </div>
            `;
            document.body.appendChild(popup);
        }

        // Function to close the popup
        function closePopup() {
            const popup = document.querySelector('.popup');
            if (popup) {
                popup.remove();
            }
        }

        // Logout function
        async function logout() {
            try {
                const response = await fetch('/auth/logout', {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }
                });

                if (response.ok) {
                    localStorage.removeItem('token');
                    window.location.href = '/login.html';
                } else {
                    alert('Logout failed. Please try again.');
                }
            } catch (error) {
                console.error('Error during logout:', error);
            }
        }

        // Load initial data
        document.addEventListener('DOMContentLoaded', () => {
            fetchClientDetails();
            searchServices();
            loadBookings();
            loadReviews();
            loadPaymentMethods();
        });
    </script>
</body>
</html>